<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Battle! ‡∏û‡∏∑‡∏ä‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß vs ‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ñ‡∏π‡πà ‚Äî Kru Pai Classroom</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f6fff6;         /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡πà‡∏≠‡∏ô‡∏•‡∏∞‡∏°‡∏∏‡∏ô */
    --fg:#1e2b1e;         /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏°‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ */
    --brand:#2ecc71;      /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏î‡∏ï‡∏±‡∏ß‡πÇ‡∏à‡∏ó‡∏¢‡πå */
    --accent:#ff4d4f;     /* ‡πÅ‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å */
    --gold:#f7b500;       /* ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå */
    --card:#ffffff;
    --muted:#8aa38a;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,#eaffea 0%, var(--bg) 50%, #ffffff 100%);
    font-family:"Noto Sans Thai", system-ui, sans-serif; color:var(--fg);
    display:flex; min-height:100vh; align-items:center; justify-content:center;
  }
  .container{ width:min(980px, 96vw); padding:20px; }
  .brand{ display:flex; align-items:center; gap:12px; justify-content:center; margin-bottom:8px; }
  .brand .logo{ width:42px; height:42px; background:radial-gradient(circle at 30% 30%, #fff, #ffd86b); border-radius:50%; box-shadow:0 8px 18px rgba(0,0,0,.12); position:relative; }
  .brand .logo::after{ content:"‚òÖ"; position:absolute; inset:0; display:grid; place-items:center; color:#ff7a00; font-weight:800; }
  h1{ text-align:center; font-weight:800; margin:8px 0 6px; letter-spacing:.2px; }
  h2{ margin:0 0 12px; font-weight:800; }
  p{ margin:8px 0; }

  .card{ background:var(--card); border-radius:22px; padding:22px; box-shadow:0 10px 30px rgba(0,0,0,.08); }
  .center{ text-align:center; }
  .grid{ display:grid; gap:16px; }

  .btn{ border:0; cursor:pointer; padding:14px 18px; border-radius:999px; font-weight:800; font-size:18px; letter-spacing:.3px; transition:.2s transform, .2s box-shadow, .2s filter; }
  .btn:active{ transform:translateY(1px); }
  .btn-lg{ padding:18px 28px; font-size:22px; }
  .btn-primary{ background:linear-gradient(135deg, #ff5a66, var(--accent)); color:white; box-shadow:0 8px 18px rgba(255,77,79,.35); }
  .btn-primary:hover{ filter:brightness(1.05); }
  .btn-outline{ background:transparent; color:var(--fg); border:2px dashed var(--muted); }

  .chips{ display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
  .chip{ background:#fff; border:2px solid #e1f5e5; color:#2a4a2a; padding:6px 12px; border-radius:20px; font-weight:700; }

  .hidden{ display:none !important; }

  /* ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏° */
  .question{ font-size: clamp(28px, 6vw, 52px); font-weight:800; color:var(--brand); margin:12px 0 8px; }
  .timer{ display:flex; align-items:center; gap:10px; justify-content:center; font-weight:800; }
  .bar{ width:100%; height:12px; background:#ffecec; border-radius:999px; overflow:hidden; }
  .bar > div{ height:100%; width:100%; background:linear-gradient(90deg, #ffd6d6, #ffb0b0); transition:width .2s linear; }

  .choices{ display:grid; grid-template-columns:1fr; gap:14px; margin-top:10px; }
  @media(min-width:520px){ .choices{ grid-template-columns:1fr 1fr; } }
  .choice{
    background:linear-gradient(135deg, #ff6a6d, var(--accent));
    color:#fff; border:none; border-radius:18px; padding:16px; font-size:20px; font-weight:800; cursor:pointer;
    box-shadow:0 10px 20px rgba(255,77,79,.25); transition:.15s transform, .15s filter;
  }
  .choice:hover{ filter:brightness(1.06); }
  .choice:active{ transform:translateY(1px); }

  .status{ min-height:56px; font-weight:800; text-align:center; margin-top:10px; font-size: clamp(22px, 5vw, 32px); }
.status.good{ color:#0b9a32; text-shadow:0 2px 0 rgba(255,255,255,.6); }
.status.bad{ color:#c70000; text-shadow:0 2px 0 rgba(255,255,255,.6); }
.status-bubble{ display:inline-block; padding:10px 16px; border-radius:999px; background:#ffffff; border:3px solid #ffe1e1; box-shadow:0 8px 16px rgba(0,0,0,.08); }
  .good{ color:#11a83a; } .bad{ color:#d10000; }

  /* ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á */
  .two-col{ display:grid; grid-template-columns:1fr; gap:16px; }
  @media(min-width:720px){ .two-col{ grid-template-columns:1fr 1fr; } }
  .list-card{ background:#fff; border:2px solid #e6f7ef; border-radius:18px; padding:14px 16px; }
  .list-card h3{ margin:6px 0 8px; font-weight:800; }
  .plant-list{ display:flex; flex-wrap:wrap; gap:10px; }
  .plant{ background:#f4fff6; border:1px solid #cff1d5; padding:8px 12px; border-radius:16px; font-weight:700; }

  /* ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô */
  .score-big{ font-size: clamp(36px, 8vw, 72px); font-weight:800; margin:6px 0 12px; }
  .badge{ font-size: clamp(18px, 3.8vw, 28px); font-weight:800; color:#fff; background:linear-gradient(135deg, #FFB800, #FF8A00); display:inline-block; padding:8px 18px; border-radius:999px; }

  /* ‡πÅ‡∏ñ‡∏ö‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤ */
  .miniBrand{ display:flex; align-items:center; gap:10px; justify-content:center; font-weight:800; color:#2b4a2b; margin:-6px 0 10px; }
  .miniBrand .dot{ width:10px; height:10px; background:linear-gradient(135deg,#ffd86b,#ff9a3c); border-radius:50%; box-shadow:0 2px 8px rgba(0,0,0,.15); }

  .watermark{ text-align:center; margin-top:14px; color:#6a8b6a; font-weight:700; }

</style>
</head>
<body>
  <div class="container grid">

    <!-- ‡∏´‡∏ô‡πâ‡∏≤ 1: ‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏Å + ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ä‡∏±‡∏î‡πÜ ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏° -->
    <section id="screen-home" class="card">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div style="font-weight:800; font-size:20px">Kru Pai Classroom</div>
      </div>
      <h1>Battle! ‡∏û‡∏∑‡∏ä‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß vs ‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ñ‡∏π‡πà</h1>
      <div class="center" style="margin:8px 0 14px;">
        <span class="badge">‡∏£‡∏∞‡∏î‡∏±‡∏ö ‡∏õ.3 ‚Äì ‡∏õ.4</span>
      </div>
      <div class="grid">
        <div class="card" style="background:#fbfff5">
          <h2>‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô (‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°)</h2>
          <p style="font-size:18px; line-height:1.7"><strong>‡∏à‡∏á‡∏ö‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ</strong> ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô <strong>‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß</strong> ‡∏´‡∏£‡∏∑‡∏≠ <strong>‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ñ‡∏π‡πà</strong> ‚Äî 
            <mark style="background:#fff2a8; padding:0 6px; border-radius:6px;">‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ 7 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠</mark> 
            ‡∏´‡∏≤‡∏Å‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß <strong>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Start</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!
          </p>
          <div class="chips" aria-hidden="true">
            <span class="chip">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏∑‡∏ä = ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</span>
            <span class="chip">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å = ‡∏™‡∏µ‡πÅ‡∏î‡∏á</span>
            <span class="chip">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 20 ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°</span>
          </div>
        </div>
        <div class="grid" style="grid-template-columns:1fr; gap:12px;">
          <input id="playerName" class="card" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π‚Ä¶" style="padding:14px 16px; border:2px dashed #cde8d1; border-radius:16px; font-size:18px;" />
          <div class="center" style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
            <button id="btnStart" class="btn btn-lg btn-primary" style="font-size:24px; padding:18px 34px; box-shadow:0 12px 26px rgba(255,77,79,.35);">
              üöÄ START ‡πÄ‡∏£‡∏¥‡πà‡∏° Battle!
            </button>
            <button id="btnExamples" class="btn btn-lg btn-outline">üìö ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏∑‡∏ä (20+20)</button>
          </div>
        </div>
      </div>
      <div class="watermark">¬© Kru Pai Classroom ¬∑ ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏ô‡∏∏‡∏Å</div>
    </section>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤ 2: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏∑‡∏ä 20+20 -->
    <section id="screen-examples" class="card hidden">
      <div class="miniBrand"><span class="dot"></span> Kru Pai Classroom</div>
      <h2 class="center">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏∑‡∏ä‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏£‡∏π‡πâ (20 + 20)</h2>
      <div class="two-col">
        <div class="list-card">
          <h3>üå± ‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß</h3>
          <div id="monoList" class="plant-list"></div>
        </div>
        <div class="list-card">
          <h3>üåº ‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ñ‡∏π‡πà</h3>
          <div id="diList" class="plant-list"></div>
        </div>
      </div>
      <div class="center" style="margin-top:14px;">
        <button id="backFromExamples" class="btn">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
        <button id="startFromExamples" class="btn btn-primary">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏° Battle ‡πÄ‡∏•‡∏¢</button>
      </div>
    </section>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤ 3: ‡πÄ‡∏Å‡∏° -->
    <section id="screen-game" class="card hidden">
      <div class="miniBrand"><span class="dot"></span> Kru Pai Classroom</div>
      <div class="grid">
        <div class="timer">
          <div class="bar" aria-label="‡∏ï‡∏±‡∏ß‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤"><div id="barFill"></div></div>
          <div><strong id="timeText">7</strong>s</div>
        </div>
        <div class="center">
          <div id="qCount" style="font-weight:800; color:#6b8f6b;">‡∏Ç‡πâ‡∏≠ 1/20</div>
          <div id="question" class="question">‚Äî</div>
        </div>
        <div class="choices">
          <button class="choice" data-pick="mono">üå± ‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß</button>
          <button class="choice" data-pick="di">üåº ‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ñ‡∏π‡πà</button>
        </div>
        <div id="status" class="status status-bubble"></div>
      </div>
    </section>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤ 4: ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô -->
    <section id="screen-result" class="card hidden center">
      <div class="miniBrand"><span class="dot"></span> Kru Pai Classroom</div>
      <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á <span id="playerLabel">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span></h2>
      <div class="score-big" id="finalScore">0 / 20</div>
      <div id="passBadge" class="badge hidden">‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡πÑ‡∏î‡πâ‡πÇ‡∏•‡πà‡∏û‡∏∑‡∏ä‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏ä‡∏¥‡∏ï üåü</div>
      <p id="finalMsg" style="font-size:18px; margin-top:10px;">‚Äî</p>
      <div style="margin-top:14px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
        <button id="btnPlayAgain" class="btn btn-primary">üîÅ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button id="btnHome" class="btn">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å (‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô)</button>
      </div>
      <div class="watermark">¬© Kru Pai Classroom</div>
    </section>

  </div>

<script>
// =======================
// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡∏ä (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏π‡∏õ‡∏≤‡∏¢‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô)
// =======================
const MONO = [
  "‡∏Å‡∏•‡πâ‡∏ß‡∏¢", "‡∏´‡∏ç‡πâ‡∏≤", "‡∏Ç‡πâ‡∏≤‡∏ß", "‡∏õ‡∏≤‡∏•‡πå‡∏°", "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß", "‡∏ö‡∏±‡∏ß", "‡∏ß‡πà‡∏≤‡∏ô‡∏´‡∏≤‡∏á‡∏à‡∏£‡∏∞‡πÄ‡∏Ç‡πâ",
  "‡∏Ç‡∏¥‡∏á", "‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏°", "‡∏´‡∏≠‡∏°", "‡πÑ‡∏ú‡πà", "‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î", "‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î", "‡∏Ç‡∏°‡∏¥‡πâ‡∏ô",
  "‡∏Å‡∏Å", "‡∏õ‡∏≠", "‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á‡∏ó‡∏∞‡πÄ‡∏•", "‡∏´‡∏ç‡πâ‡∏≤‡πÅ‡∏ù‡∏Å", "‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏µ‡∏¢‡∏ß", "‡∏≠‡πâ‡∏≠‡∏¢"
];
const DI = [
  "‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á", "‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö", "‡∏ñ‡∏±‡πà‡∏ß", "‡∏ó‡∏≤‡∏ô‡∏ï‡∏∞‡∏ß‡∏±‡∏ô", "‡∏û‡∏£‡∏¥‡∏Å", "‡∏°‡∏∞‡πÄ‡∏Ç‡∏∑‡∏≠", "‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á",
  "‡∏ö‡∏±‡∏ß‡∏ö‡∏Å", "‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö", "‡∏°‡∏∞‡∏•‡∏¥", "‡πÅ‡∏ï‡∏á‡∏Å‡∏ß‡∏≤", "‡∏°‡∏∞‡∏ô‡∏≤‡∏ß", "‡∏Ç‡∏ô‡∏∏‡∏ô", "‡∏ù‡πâ‡∏≤‡∏¢",
  "‡πÄ‡∏á‡∏≤‡∏∞", "‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "‡∏°‡∏∞‡πÄ‡∏Ç‡∏∑‡∏≠‡πÄ‡∏ó‡∏®", "‡∏ü‡∏±‡∏Å‡∏ó‡∏≠‡∏á", "‡∏•‡∏≥‡πÑ‡∏¢", "‡∏°‡∏∞‡∏Å‡∏£‡∏π‡∏î"
];

// ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° [ {name, ans:"mono"|"di"}, ... ]
const ALL_ITEMS = [
  ...MONO.map(n => ({ name:n, ans:"mono" })),
  ...DI.map(n => ({ name:n, ans:"di" }))
];

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 20 ‡∏Ç‡πâ‡∏≠
function pickRandom20(arr){
  const a = [...arr];
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a.slice(0,20);
}

// ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á DOM
const screens = {
  home: document.getElementById('screen-home'),
  examples: document.getElementById('screen-examples'),
  game: document.getElementById('screen-game'),
  result: document.getElementById('screen-result')
};
const monoList = document.getElementById('monoList');
const diList = document.getElementById('diList');
const btnExamples = document.getElementById('btnExamples');
const backFromExamples = document.getElementById('backFromExamples');
const startFromExamples = document.getElementById('startFromExamples');
const btnStart = document.getElementById('btnStart');
const playerNameInput = document.getElementById('playerName');

const qCount = document.getElementById('qCount');
const question = document.getElementById('question');
const statusBox = document.getElementById('status');
const timeText = document.getElementById('timeText');
const barFill = document.getElementById('barFill');
const choiceButtons = Array.from(document.querySelectorAll('.choice'));

const playerLabel = document.getElementById('playerLabel');
const finalScore = document.getElementById('finalScore');
const finalMsg = document.getElementById('finalMsg');
const passBadge = document.getElementById('passBadge');
const btnPlayAgain = document.getElementById('btnPlayAgain');
const btnHome = document.getElementById('btnHome');

// ‡πÄ‡∏ï‡∏¥‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏∑‡∏ä
function renderExamples(){
  monoList.innerHTML = MONO.map(p=>`<span class="plant">${p}</span>`).join('');
  diList.innerHTML = DI.map(p=>`<span class="plant">${p}</span>`).join('');
}
renderExamples();

// ‡∏Å‡∏≤‡∏£‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
function show(id){
  Object.values(screens).forEach(sec=>sec.classList.add('hidden'));
  screens[id].classList.remove('hidden');
}

btnExamples.addEventListener('click', ()=> show('examples'));
backFromExamples.addEventListener('click', ()=> show('home'));
startFromExamples.addEventListener('click', ()=> startGame());
btnStart.addEventListener('click', ()=> startGame());

// -----------------------
// ‡πÄ‡∏Å‡∏°‡∏´‡∏•‡∏±‡∏Å
// -----------------------
let deck = [];
let index = 0;
let score = 0;
let timer = null;
const LIMIT = 7; // ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠

function startGame(){
  // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  deck = pickRandom20(ALL_ITEMS);
  index = 0; score = 0; statusBox.textContent = '';
  show('game');
  nextQuestion();
}

function nextQuestion(){
  if(index >= deck.length){
    return endGame();
  }
  const item = deck[index];
  qCount.textContent = `‡∏Ç‡πâ‡∏≠ ${index+1}/${deck.length}`;
  question.textContent = item.name; // ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏∑‡∏ä = ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô CSS)
  statusBox.textContent = '';
  // ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°
  choiceButtons.forEach(b=>{ b.disabled=false; b.style.opacity=1; });
  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ 7 ‡∏ß‡∏¥
  startTimer(LIMIT, ()=>{
    // ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤: ‡∏ô‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
    flash(false);
    setTimeout(()=>{ index++; nextQuestion(); }, 500);
  });
}

// ‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ + ‡πÅ‡∏ñ‡∏ö‡∏•‡∏î‡∏•‡∏á
function startTimer(seconds, onTimeout){
  clearInterval(timer);
  let remain = seconds;
  timeText.textContent = remain;
  barFill.style.width = '100%';
  const total = seconds;
  timer = setInterval(()=>{
    remain -= 0.1; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 100ms ‡πÉ‡∏´‡πâ‡πÅ‡∏ñ‡∏ö‡∏ö‡∏≤‡∏£‡πå‡∏•‡∏∑‡πà‡∏ô
    if(remain <= 0){
      clearInterval(timer);
      timeText.textContent = 0;
      barFill.style.width = '0%';
      onTimeout && onTimeout();
    }else{
      timeText.textContent = Math.ceil(remain);
      barFill.style.width = `${(remain/total)*100}%`;
    }
  }, 100);
}

// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
choiceButtons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    if(index >= deck.length) return;
    const pick = btn.getAttribute('data-pick');
    // ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏Å‡∏î‡∏ã‡πâ‡∏≥
    choiceButtons.forEach(b=>{ b.disabled=true; b.style.opacity=.7; });
    clearInterval(timer);
    const ok = (pick === deck[index].ans);
    if(ok) score++;
    flash(ok);
    setTimeout(()=>{ index++; nextQuestion(); }, 500);
  });
});

function flash(ok){
  statusBox.textContent = ok ? '‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πâ‡∏≤! ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å üåü' : '‡πÇ‡∏≠‡πä‡∏∞ ‡∏û‡∏•‡∏≤‡∏î‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏ô‡∏∞ üå±';
  statusBox.className = 'status ' + (ok ? 'good' : 'bad');
}

function endGame(){
  show('result');
  const name = (playerNameInput.value || '‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô').trim();
  playerLabel.textContent = name;
  finalScore.textContent = `${score} / ${deck.length}`;
  passBadge.classList.add('hidden');
  if(score >= 15){
    passBadge.classList.remove('hidden');
    finalMsg.textContent = '‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡πÑ‡∏î‡πâ 15 ‡∏Ç‡πâ‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡πÅ‡∏•‡πâ‡∏ß üéâ';
  }else{
    finalMsg.textContent = '‡∏™‡∏π‡πâ‡πÜ ‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ 15 ‡∏Ç‡πâ‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡∏ô‡∏∞ ‚ú®';
  }
}

btnPlayAgain.addEventListener('click', ()=> startGame());
btnHome.addEventListener('click', ()=> show('home'));

</script>
</body>
</html>
